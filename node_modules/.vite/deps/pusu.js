import "./chunk-V4OQ3NZ2.js";

// node_modules/pusu/lib/es/index.js
var log = function(config, action, data, meta) {
  var _a;
  if (config === null || config === void 0 ? void 0 : config.enableLogging) {
    var info = { publication: (_a = config.name) !== null && _a !== void 0 ? _a : "Unknown", action };
    if (data) {
      info.data = data;
    }
    if (meta) {
      info.meta = meta;
    }
    console.log("pusu", info);
  }
};
var createPublication = function(config) {
  var publication = {
    config,
    subscribers: []
  };
  log(config, "create", void 0);
  return publication;
};
var publish = function(publication, data) {
  log(publication.config, "publish", data, void 0);
  for (var _i = 0, _a = publication.subscribers; _i < _a.length; _i++) {
    var subscriber = _a[_i];
    log(publication.config, "notify", data, {
      subscriber: subscriber.name
    });
    subscriber(data);
  }
};
var subscribe = function(publication, subscriber) {
  log(publication.config, "subscribe", void 0, {
    subscriber: subscriber.name
  });
  var subscribers = publication.subscribers;
  subscribers.push(subscriber);
  return function unsubscribe() {
    log(publication.config, "unsubscribe", void 0, {
      subscriber: subscriber.name
    });
    var index = subscribers.indexOf(subscriber);
    if (index > -1) {
      subscribers.splice(index, 1);
    }
  };
};
export {
  createPublication,
  publish,
  subscribe
};
//# sourceMappingURL=pusu.js.map
